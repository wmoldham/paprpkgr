---
title: "Title"

author:
- William M. Oldham:
    institute: bwh
    correspondence: true
    email: woldham@bwh.harvard.edu
    
institute:
- bwh: Department of Medicine, Brigham and Women's Hospital and Harvard Medical School, Boston, MA

bibliography: 
- library.json
- packages.bib
csl: cell-metabolism.csl
link-citations: yes

output: 
  bookdown::word_document2:
    reference_docx: !expr system.file("manuscript", "template.docx", package = "X")
    df_print: kable
    fig_caption: true
    number_sections: false
    pandoc_args:
      - '--lua-filter=scholarly-metadata.lua'
      - '--lua-filter=author-info-blocks.lua'
      - '--lua-filter=pagebreak.lua'
      # - '--lua-filter=multiple-bibliographies.lua'

compact-title: true
geometry: margin = 0.75in
fontsize: 11pt
mainfont: Calibri
graphics: yes
---

```{r setup, include = FALSE}
# library(X)
devtools::load_all()

knitr::opts_chunk$set(
  echo = FALSE, 
  warning = FALSE, 
  message = FALSE, 
  out.width = "80%", 
  out.extra = ""
)

knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

knitr::opts_knit$set(kable.force.latex = FALSE)

options(tinytex.verbose = TRUE)

targets::tar_load(
  c(
    m1_figure, 
  )
)
```

# Summary

# Keywords

\newpage

# Introduction

\newpage

# Results

\newpage

# Discussion

\newpage

# Acknowledgements

# Author Contributions

# Declaration of Interests

\newpage

\newpage

# Figure Legends

(ref:m1) **Caption.** Info.

```{r}
figs <- 
  list.files(
    system.file(
      "manuscript/figures", 
      package = "package"
    ), 
    pattern = "m\\d{1}\\.png"
  ) %>% 
  rlang::set_names(stringr::str_extract(., "^.*(?=\\.png)"))
```

```{r results = "asis"}
out <- 
  purrr::imap(
    figs, 
    ~ cat("Figure ", stringr::str_extract(.y, "\\d"), ": (ref:", .y, ")\n\n", sep = "")
  )
```

\newpage

# Tables

\newpage

# Methods

\newpage

# References

::: {#refs} 
:::

\newpage

# Figures

```{r m1, fig.cap = "(ref:m1)"}
knitr::include_graphics(
  system.file(
    "manuscript/figures/m1.png",
    package = "package"
  )
)
```

\newpage
